# ğŸ“§ HÆ°á»›ng Dáº«n Láº¥y Gmail App Password

## ğŸ¯ Má»¥c ÄÃ­ch
Gmail App Password cho phÃ©p á»©ng dá»¥ng gá»­i email thay báº¡n má»™t cÃ¡ch an toÃ n. ChÃºng ta dÃ¹ng nÃ³ cho Activity 4: Forgot Password Email.

---

## âš ï¸ Äiá»u Kiá»‡n TiÃªn Quyáº¿t

### YÃªu Cáº§u Báº¯t Buá»™c:
1. âœ… Pháº£i cÃ³ tÃ i khoáº£n Gmail
2. âœ… Pháº£i báº­t **2-Step Verification** (XÃ¡c minh 2 bÆ°á»›c)
3. âœ… KhÃ´ng dÃ¹ng Gmail cá»§a trÆ°á»ng/cÃ´ng ty (pháº£i lÃ  Gmail cÃ¡ nhÃ¢n)

**âš ï¸ LÆ¯U Ã QUAN TRá»ŒNG:**
- **KHÃ”NG thá»ƒ** dÃ¹ng password Gmail thÆ°á»ng
- **PHáº¢I** dÃ¹ng App Password (16 kÃ½ tá»± Ä‘áº·c biá»‡t)
- Gmail trÆ°á»ng/cÃ´ng ty thÆ°á»ng **KHÃ”NG cho phÃ©p** táº¡o App Password

---

## ğŸ” BÆ°á»›c 1: Báº­t 2-Step Verification

### 1.1. Truy cáº­p Google Account Security
Má»Ÿ trÃ¬nh duyá»‡t vÃ  truy cáº­p: **https://myaccount.google.com/security**

### 1.2. TÃ¬m má»¥c "2-Step Verification"
Scroll xuá»‘ng tÃ¬m pháº§n:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  How you sign in to Google               â”‚
â”‚                                          â”‚
â”‚  2-Step Verification                     â”‚
â”‚  Add an extra layer of security          â”‚
â”‚  [Off] or [Get started]                  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 1.3. Báº­t 2-Step Verification

**Náº¿u Ä‘ang OFF:**
1. Click **[Get started]**
2. Nháº­p láº¡i password Gmail
3. Nháº­p sá»‘ Ä‘iá»‡n thoáº¡i Ä‘á»ƒ nháº­n mÃ£ xÃ¡c thá»±c
4. Nháº­p mÃ£ 6 sá»‘ tá»« SMS
5. Click **Turn on** Ä‘á»ƒ kÃ­ch hoáº¡t

**Náº¿u Ä‘Ã£ ON:**
- âœ… Bá» qua bÆ°á»›c nÃ y, chuyá»ƒn sang BÆ°á»›c 2

### 1.4. XÃ¡c nháº­n Ä‘Ã£ báº­t thÃ nh cÃ´ng
Sau khi báº­t, báº¡n sáº½ tháº¥y:
```
2-Step Verification: ON âœ…
```

---

## ğŸ”‘ BÆ°á»›c 2: Táº¡o App Password

### 2.1. Truy cáº­p App Passwords
**CÃ¡ch 1: Link trá»±c tiáº¿p** (Khuyáº¿n nghá»‹)
Truy cáº­p: **https://myaccount.google.com/apppasswords**

**CÃ¡ch 2: Tá»« Security page**
1. á» trang Security: https://myaccount.google.com/security
2. Scroll xuá»‘ng má»¥c **"How you sign in to Google"**
3. TÃ¬m **"2-Step Verification"** â†’ Click vÃ o
4. Scroll xuá»‘ng dÆ°á»›i cÃ¹ng
5. TÃ¬m **"App passwords"** â†’ Click vÃ o

### 2.2. Nháº­p láº¡i password
- Google sáº½ yÃªu cáº§u nháº­p láº¡i password Ä‘á»ƒ xÃ¡c thá»±c
- Nháº­p password Gmail cá»§a báº¡n
- Click **Next**

### 2.3. Táº¡o App Password má»›i

Báº¡n sáº½ tháº¥y trang **"App passwords"**:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  App passwords                                  â”‚
â”‚                                                â”‚
â”‚  Select the app and device you want to        â”‚
â”‚  generate the app password for.               â”‚
â”‚                                                â”‚
â”‚  Select app:    [Mail â–¼]                      â”‚
â”‚  Select device: [Windows Computer â–¼]          â”‚
â”‚                                                â”‚
â”‚  [Generate]                                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**Chá»n thÃ´ng tin:**
1. **Select app:** Chá»n **Mail**
2. **Select device:** Chá»n **Windows Computer** (hoáº·c **Other** â†’ Nháº­p "NodeJS App")
3. Click **[Generate]**

### 2.4. Copy App Password

Google sáº½ hiá»ƒn thá»‹ máº­t kháº©u 16 kÃ½ tá»±:

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Your app password for Windows Computer        â”‚
â”‚                                                â”‚
â”‚  abcd efgh ijkl mnop                          â”‚ â† Copy cáº£ dÃ²ng nÃ y
â”‚                                                â”‚
â”‚  [Done]                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

**âš ï¸ QUAN TRá»ŒNG:**
- Copy **Cáº¢ DÃ’NG** nÃ y (bao gá»“m cáº£ khoáº£ng tráº¯ng)
- VD: `abcd efgh ijkl mnop`
- Chá»‰ hiá»‡n 1 láº§n duy nháº¥t, sau khi click **[Done]** sáº½ khÃ´ng xem láº¡i Ä‘Æ°á»£c
- Náº¿u quÃªn, pháº£i táº¡o má»›i

### 2.5. LÆ°u App Password
LÆ°u vÃ o file text táº¡m:

```
EMAIL_USER=your_email@gmail.com
EMAIL_PASSWORD=abcd efgh ijkl mnop
```

**LÆ°u Ã½ Ä‘á»‹nh dáº¡ng:**
- CÃ³ thá»ƒ giá»¯ nguyÃªn khoáº£ng tráº¯ng: `abcd efgh ijkl mnop`
- Hoáº·c bá» khoáº£ng tráº¯ng: `abcdefghijklmnop`
- **Cáº£ 2 cÃ¡ch Ä‘á»u hoáº¡t Ä‘á»™ng!**

---

## âš™ï¸ BÆ°á»›c 3: Cáº¥u HÃ¬nh vÃ o Project

### 3.1. Má»Ÿ file .env
```bash
# Má»Ÿ file nÃ y
D:\Class\Class_Phat_Trien_Phan_Mem_Ma_Nguon_Mo\buoi4\group-17--project\backend\.env
```

### 3.2. Thay tháº¿ cÃ¡c giÃ¡ trá»‹
TÃ¬m dÃ²ng nÃ y:
```env
EMAIL_USER=your_gmail@gmail.com
EMAIL_PASSWORD=your_16_char_app_password_here
FRONTEND_URL=http://localhost:3001
```

Thay báº±ng (VD):
```env
EMAIL_USER=huunhanvo@gmail.com
EMAIL_PASSWORD=abcd efgh ijkl mnop
FRONTEND_URL=http://localhost:3001
```

**Hoáº·c bá» khoáº£ng tráº¯ng:**
```env
EMAIL_PASSWORD=abcdefghijklmnop
```

### 3.3. LÆ°u file
- Nháº¥n `Ctrl + S`
- **âš ï¸ QUAN TRá»ŒNG:** KhÃ´ng commit file `.env` lÃªn Git!

---

## ğŸ”„ BÆ°á»›c 4: Restart Backend

### 4.1. Stop backend hiá»‡n táº¡i
```bash
# Trong terminal Ä‘ang cháº¡y backend
# Nháº¥n: Ctrl + C
```

### 4.2. Start láº¡i backend
```bash
cd D:\Class\Class_Phat_Trien_Phan_Mem_Ma_Nguon_Mo\buoi4\group-17--project\backend
node server.js
```

### 4.3. Kiá»ƒm tra console
Náº¿u thÃ nh cÃ´ng, khÃ´ng cÃ³ lá»—i vá» "Email" trong console.

---

## âœ… BÆ°á»›c 5: Test Gá»­i Email

### 5.1. Truy cáº­p Frontend
Má»Ÿ trÃ¬nh duyá»‡t: **http://localhost:3001**

### 5.2. Test Forgot Password
1. á» trang **Login**, click **"Forgot Password?"**
2. Nháº­p email: `admin@example.com`
3. Click **"Send Reset Link"**
4. Äá»£i vÃ i giÃ¢y

### 5.3. Kiá»ƒm tra Console Backend
Xem log trong terminal backend:
```
âœ‰ï¸  Sending reset email to: admin@example.com
âœ… Reset password email sent successfully
```

### 5.4. Kiá»ƒm tra Email
1. **Má»Ÿ Gmail cá»§a báº¡n** (EMAIL_USER)
2. Trong **Inbox** hoáº·c **Spam**, tÃ¬m email tá»« á»©ng dá»¥ng
3. Subject: **"Password Reset Request"**
4. Ná»™i dung cÃ³ link reset password

**âš ï¸ LÆ¯U Ã:**
- Email cÃ³ thá»ƒ vÃ o **Spam** láº§n Ä‘áº§u tiÃªn
- ÄÃ¡nh dáº¥u **"Not Spam"** Ä‘á»ƒ láº§n sau vÃ o Inbox

### 5.5. Test Reset Password
1. Click link trong email
2. Hoáº·c copy token tá»« email
3. Nháº­p password má»›i
4. Click **"Reset Password"**
5. Login vá»›i password má»›i

---

## ğŸ¨ Email Template Hiá»‡n Táº¡i

Email sáº½ trÃ´ng nhÆ° nÃ y:

```
Subject: Password Reset Request

Hi there,

You requested to reset your password for your account.

Click the link below to reset your password:
http://localhost:3001/reset-password/abc123xyz456...

This link will expire in 30 minutes.

If you didn't request this, please ignore this email.

Thanks,
User Management Team
```

---

## ğŸ› Troubleshooting

### Lá»—i: "Invalid login: 535 Authentication failed"
```
NguyÃªn nhÃ¢n: App Password sai hoáº·c chÆ°a táº¡o
Giáº£i phÃ¡p:
1. Kiá»ƒm tra EMAIL_PASSWORD trong .env
2. Äáº£m báº£o Ä‘Ã£ copy Ä‘Ãºng 16 kÃ½ tá»±
3. Táº¡o láº¡i App Password má»›i
4. Restart backend
```

### Lá»—i: "Username and Password not accepted"
```
NguyÃªn nhÃ¢n: ChÆ°a báº­t 2-Step Verification
Giáº£i phÃ¡p:
1. VÃ o https://myaccount.google.com/security
2. Báº­t 2-Step Verification
3. Táº¡o láº¡i App Password
```

### Lá»—i: "Less secure app access"
```
NguyÃªn nhÃ¢n: Äang dÃ¹ng password thÆ°á»ng thay vÃ¬ App Password
Giáº£i phÃ¡p:
âŒ KHÃ”NG báº­t "Less secure app access" (khÃ´ng an toÃ n)
âœ… PHáº¢I dÃ¹ng App Password (16 kÃ½ tá»±)
```

### Email khÃ´ng nháº­n Ä‘Æ°á»£c
```
NguyÃªn nhÃ¢n: Email vÃ o Spam hoáº·c sai Ä‘á»‹a chá»‰
Giáº£i phÃ¡p:
1. Check Spam folder
2. Äá»£i 1-2 phÃºt (cÃ³ thá»ƒ bá»‹ delay)
3. Kiá»ƒm tra EMAIL_USER trong .env cÃ³ Ä‘Ãºng khÃ´ng
4. Check backend console cÃ³ lá»—i khÃ´ng
```

### Lá»—i: "Nodemailer ETIMEDOUT"
```
NguyÃªn nhÃ¢n: Firewall cháº·n port 587 hoáº·c 465
Giáº£i phÃ¡p:
1. Check máº¡ng cÃ³ block SMTP khÃ´ng
2. Thá»­ Ä‘á»•i port trong config/email.js
3. Náº¿u dÃ¹ng máº¡ng trÆ°á»ng, thá»­ Ä‘á»•i sang 4G
```

---

## ğŸ” Security Best Practices

### âœ… NÃªn lÃ m:
1. âœ… DÃ¹ng App Password thay vÃ¬ password thÆ°á»ng
2. âœ… Báº­t 2-Step Verification
3. âœ… LÆ°u App Password trong `.env`
4. âœ… ThÃªm `.env` vÃ o `.gitignore`
5. âœ… Revoke App Password khi khÃ´ng dÃ¹ng ná»¯a

### âŒ KHÃ”NG nÃªn lÃ m:
1. âŒ Share App Password cÃ´ng khai
2. âŒ Commit `.env` lÃªn Git
3. âŒ DÃ¹ng password Gmail thÆ°á»ng
4. âŒ Báº­t "Less secure app access"
5. âŒ DÃ¹ng Gmail trÆ°á»ng/cÃ´ng ty

---

## ğŸ—‘ï¸ BÆ°á»›c 6: XÃ³a App Password (Khi KhÃ´ng DÃ¹ng)

### 6.1. Truy cáº­p App Passwords
VÃ o: **https://myaccount.google.com/apppasswords**

### 6.2. Xem danh sÃ¡ch
Báº¡n sáº½ tháº¥y:
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Windows Computer (Mail)               â”‚
â”‚  Created: Jan 15, 2024                 â”‚
â”‚  [Revoke] [X]                          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 6.3. Revoke
- Click **[X]** hoáº·c **[Revoke]**
- XÃ¡c nháº­n xÃ³a
- App Password ngay láº­p tá»©c khÃ´ng cÃ²n hoáº¡t Ä‘á»™ng

---

## ğŸ“¸ Screenshots Cáº§n Chá»¥p cho BÃ¡o CÃ¡o

1. **Google Account Security** - 2-Step Verification ON
2. **App Passwords page** - List of created passwords
3. **Generated App Password** - 16 kÃ½ tá»± (che bá»›t)
4. **File .env** - EMAIL_USER vÃ  EMAIL_PASSWORD (che password)
5. **Frontend** - Forgot Password form
6. **Frontend** - Success message "Email sent"
7. **Gmail Inbox** - Email nháº­n Ä‘Æ°á»£c
8. **Email Content** - Reset link
9. **Frontend** - Reset Password form
10. **Backend Console** - Email sent log

---

## ğŸ’¡ Tips

### Gmail Limits
- **Gá»­i tá»‘i Ä‘a:** 500 emails/ngÃ y (Gmail cÃ¡ nhÃ¢n)
- **Rate limit:** Khoáº£ng 100 emails/giá»
â†’ **Äá»§ cho testing vÃ  demo!**

### Testing
```javascript
// Náº¿u muá»‘n test khÃ´ng gá»­i email tháº­t, comment code nÃ y
// trong config/email.js:

// const info = await transporter.sendMail(mailOptions);
console.log('EMAIL WOULD BE SENT TO:', email);
console.log('RESET TOKEN:', resetToken);
return true;  // Fake success
```

### Alternative Services
Náº¿u khÃ´ng dÃ¹ng Ä‘Æ°á»£c Gmail:
1. **SendGrid** - 100 emails/day miá»…n phÃ­
2. **Mailgun** - 5000 emails/month Ä‘áº§u miá»…n phÃ­
3. **Mailtrap** - Chá»‰ cho testing (khÃ´ng gá»­i tháº­t)

---

## ğŸ”— Links Há»¯u Ãch

- **Google Account Security:** https://myaccount.google.com/security
- **App Passwords:** https://myaccount.google.com/apppasswords
- **2-Step Verification:** https://myaccount.google.com/signinoptions/two-step-verification
- **Nodemailer Docs:** https://nodemailer.com/about/

---

âœ… **HoÃ n táº¥t! BÃ¢y giá» á»©ng dá»¥ng cÃ³ thá»ƒ gá»­i email reset password!**
